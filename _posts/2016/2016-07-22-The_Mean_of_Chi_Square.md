---
title: 卡方校验的意义
tags: [ 日志, 数学]
---
近来学习统计的相关知识, 其中有不少地方涉及到统计显著性的内容. 统计显著性有多种方法表示, 卡方校验是一个最常用的.

## 什么是卡方校验?
卡方, 数学上表示为: &chi;<sup>2</sup>, &chi; 是希腊字母, 很像拉丁字母 x , 读音类似于中文的 '开' 字. 我觉的很奇怪, 为什么叫卡方, 不是更应该叫开方吗? 可能 "开方" 已经用来表示开平方的简称了吧. 这是这个名称, 就说道这里, 接下来我们来谈一谈卡方的数学意义.

卡方是用来表示预期值与观察者之间的背离. 数学上卡方的计算如下:

$$
\chi^{2} = \sum \frac{(o-e)^2}{e}
$$

其中 `o` 是观察值, `e` 是期望值.

我们用一个例子来看一下怎么计算卡方的.

假设 880 株豌豆, 其中有 639 株种子是绿色的, 241 是黄色的. 如果这 880 株豌豆的基因类型都是 Gg 的, 那么根据孟德尔遗传定律, 我们知道, 绿的种子与黄的种子应该是3:1, 880 株豌豆的话, 应该有 660 株是绿的, 220 株是黄的. 那么现在,我们计算这个观察的&chi;<sup>2</sup>

颜色 | 期望值 | 观察值 | 差值平方 | 差值平方除以期望
-----|--------|------|----------|------------
绿色 | 660    | 639  | 441    | 0.668
黄色 | 220    | 241  | 441    | 2.004

所以 &chi;<sup>2</sup> 为 2.672 . 那么这个值表示的是什么意思呢? 观察和期望之间是吻合呢还是不吻合呢?

我们用概率 p 来表示理论期望与实际观察之间偏离的概率, **当 p &lt; 0.05 的时候, 表示假说可以接收**.

用 df 表示自由度, 也就是研究的类别数目减去1. 自由度, 偏离概率以及卡方之间的关系, 可以通过下表来表示:

偏离概率/自由度<br>(p/fd) | 0.95 |  0.90 | 0.80 | 0.70 |0.50 |0.30 | 0.20| 0.10 | 0.05 | 0.01 | 0.001
---|---|----|-----|-----|-----|-----
1 | 0.04 | 0.02 | 0.06 | 0.15 | 0.46 | 1.07 | 1.64 | 2.71 | 3.84 | 6.64 | 10.83
2 | 0.10 | 0.21 | 0.45 | 0.71 | 1.39 | 2.41 | 3.22 | 4.60 | 5.99 | 9.21 | 13.82
3 | 0.35 | 0.58 | 1.01 | 1.42 | 2.37 | 3.66 | 4.64 | 6.25 | 7.82 | 11.34 | 16.27
4 | 0.71 | 1.06 | 1.65 | 2.20 | 3.36 | 4.88| 5.99 | 7.78 | 9.49 | 13.28 | 18.47
5 | 1.14 | 1.61 | 2.34 | 3.00 | 4.35 | 6.06 | 7.29 | 9.24 | 11.07 | 15.09 | 20.52
6 | 1.63 |2.20 | 3.07 | 3.83 | 5.35 | 7.23 | 8.56 | 10.64 | 12.59 | 16.81 | 22.46
7 | 2.17 |2.83 | 3.82 | 4.67 | 6.35 | 8.38 | 9.80 | 12.02 | 14.07 | 18.48 | 24.32
8 | 2.73 |3.49 | 4.59 | 5.53 | 7.34 | 9.52 | 11.03 | 13.36 | 15.51 | 20.09 | 26.12
9 | 3.32 |4.17 | 5.38 | 6.39 | 8.34 | 10.66 | 12.24 | 14.68 | 16.92 | 21.67 | 27.88
10 | 3.94 |4.86 | 6.18 | 7.27 | 9.34 | 11.78 | 13.44 | 15.99 | 18.31 | 23.21 | 29.59

这个表第一列是自由度, 第一行是观察值与期望 **背离** 概率. 中间的内容是 &chi;<sup>2</sup> 的值.

结合上面的我们的例子, 自由度是 1, 而 &chi;<sup>2</sup> 为 2.004, 所以观察值与期望之间的背离概率位于0.10~0.20 之间, 这个值肯定是大于 0.05 的, 所以我的假设 (全部的豌豆基因类型都是 Gg) 从统计上来看, 是不能被接收的.

需要特别注意这里的 p 指的是背离的概率, 所以, p 越大, 说明观察的数据越背离期望, 也就是说, 理论预期可能越可能不正确. &chi;<sup>2</sup> 越小, 说明预期和观察越吻合, 也就是说, 理论预期越可能是正确的.

统计中关于是否显著的判断就是根据 p 值来的. 也就是所谓的 p-value.
